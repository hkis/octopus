<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link title="style" media="screen" href="css/default.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="js/jquery.1.4.4.min.js"></script>
<script type="text/javascript" src="js/uploadImg.js"></script>
<script type="text/javascript">
var imgData = '',UpImages,UpImages1;
$(document).ready(function(){
    //禁止选中
    Bing.forbidSelect();
    UpImages = new Bing.UpImg({fileEle:'#parent #imgFile',allowTypes:'jpg jpeg png',fn:function(){$('#parent #loading').fadeIn(1);}});
})
function loadFun(){
    UpImages._append({parEle:$('#parent #preview'),data:imgData,fn:function(arg){
        var imgSvalue = new Bing.ImgSizing(arg);//图片大小调整，使其不超出可视区域
        $('#parent #preview img').css(imgSvalue);
        
        //截取框大小和坐标调整，使截取框
        var cutS = new Bing.CutImg({
            parEle:$('#parent #preview'),
            cutPro:0.9,
            width:imgSvalue.width,
            height:imgSvalue.height,
            imgLeft:imgSvalue.left,
            imgTop:imgSvalue.top,
            fn:submitShow
        });
        cutS.addCutDiv(cutS.cutSpecification);
        //按钮显示出来之后，点击实现提交功能
        
        //为截图框添加拖动功能  这里需要添加限制区域要求截图框既不能超出图片大小也不能超出可视区域大小
        new Bing.Drag({pro:0.9,moveBar:$('#parent #preview #cutDiv'),imgEle:$('#parent #preview img'),parEle:$('#parent #preview'),moveBarIds:'top left bottom right top_left top_right bottom_left bottom_right'});
        
        //为截图功能添加鼠标中轴缩放功能
        new Bing.Scroll({eventEle:[$('#parent #preview img'),$('#parent #cutDiv')],parEle:$('#parent #preview')});
        
        function submitShow(){
            $('#parent #submit').fadeIn(50);
            $('#parent #submit').one('click',function(){
                cutS.submitCutData({parentEle:$('#parent #preview'),parEle:$('#parent #preview img'),cutDiv:$('#parent #cutDiv'),url:'http://smop.staff.ifeng.com/PhoenixWeb/Ashx/ImagesProcess.ashx',uid:$('#parent #uid').val(),fu:hideSubmit});
            });
        }
    }});
    $('#parent #loading').fadeOut(1);
}
function submitShow(){
    console.log('添加进去了');
}
function hideSubmit(){
    $('#parent #submit').fadeOut(20);
}







$(document).ready(function(){
    UpImages1 = new Bing.UpImg({fileEle:'#parent1 #imgFile',allowTypes:'jpg jpeg png',fn:function(){$('#parent1 #loading').fadeIn(1);}});
})
function loadFun1(){
    UpImages1._append({parEle:$('#parent1 #preview'),data:imgData,fn:function(arg){
        var imgSvalue = new Bing.ImgSizing(arg);//图片大小调整，使其不超出可视区域
        $('#parent1 #preview img').css(imgSvalue);
        //截取框大小和坐标调整，使截取框
        var cutS = new Bing.CutImg({
            parEle:$('#parent1 #preview'),
            cutPro:0.9,
            width:imgSvalue.width,
            height:imgSvalue.height,
            imgLeft:imgSvalue.left,
            imgTop:imgSvalue.top,
            fn:submitShow
        });
        cutS.addCutDiv(cutS.cutSpecification);
        //按钮显示出来之后，点击实现提交功能
         //为截图框添加拖动功能  这里需要添加限制区域要求截图框既不能超出图片大小也不能超出可视区域大小
        new Bing.Drag({pro:0.9,moveBar:$('#parent1 #preview #cutDiv'),imgEle:$('#parent1 #preview img'),parEle:$('#parent1 #preview'),moveBarIds:'top left bottom right top_left top_right bottom_left bottom_right'});
        //为截图功能添加鼠标中轴缩放功能
        new Bing.Scroll({eventEle:[$('#parent1 #preview img'),$('#parent1 #cutDiv')],parEle:$('#parent1 #preview')});
        
        function submitShow(){
            $('#parent1 #submit').fadeIn(50);
            $('#parent1 #submit').one('click',function(){
                cutS.submitCutData({parentEle:$('#parent1 #preview'),parEle:$('#parent1 #preview img'),cutDiv:$('#parent1 #cutDiv'),url:'http://smop.staff.ifeng.com/PhoenixWeb/Ashx/ImagesProcess1.ashx',uid:$('#parent1 #uid').val(),fu:hideSubmit1});
            });
        }
    }});
    $('#parent1 #loading').fadeOut(1);
}
function submitShow1(){
    console.log('添加进去了');
}
function hideSubmit1(){
    $('#parent1 #submit').fadeOut(20);
}
</script>
<title>图片上传</title>
</head>

<body>
<iframe name="ifr" id="iframe_hidden"></iframe>
<div id="parent">
    <form id="img_form" name="imgForm" enctype="multipart/form-data" action="http://smop.staff.ifeng.com/PhoenixWeb/Ashx/ImagesProcess.ashx" target="ifr" method="post" >
        <input type="hidden" name="uid" id="uid" value="binggege" />
        <input type="hidden" name="action" value="upload" />
        <label id="action">请上传格式为jpeg，jpg或png的图片：</label>
        <input type="file" name="filedata" id="imgFile" />
    </form>
    <div id="preview"></div>
    <span id="loading">图片上传中</span>
    <input type="button" value="提交" id="submit" />
</div>
<div id="parent1">
    <form id="img_form" name="imgForm" enctype="multipart/form-data" action="http://smop.staff.ifeng.com/PhoenixWeb/Ashx/ImagesProcess1.ashx" target="ifr" method="post" >
        <input type="hidden" name="uid" id="uid"  value="hahhahahhah" />
        <input type="hidden" name="action" value="upload" />
        <label id="action">请上传格式为jpeg，jpg或png的图片：</label>
        <input type="file" name="filedata" id="imgFile" />
    </form>
    <div id="preview"></div>
    <span id="loading">图片上传中</span>
    <input type="button" value="提交" id="submit" />
</div>
</body>
</html>